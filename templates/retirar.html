<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ t('withdraw_product') }} - Estoque</title>

  <!-- Favicon -->
  <link rel="shortcut icon" href="{{ url_for('static', filename='img/LogoAtena.png') }}" type="image/x-icon">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
  <!-- Estilos -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style/reset.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style/home.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style/retirada.css') }}">
</head>
<body>
  <!-- Header com Menu e Busca -->
    <header class="top-bar">
        <div class="logo-container">
            <img src="{{ url_for('static', filename='img/LogoAtena.png') }}" alt="Logo" class="logo">
            <h1>{{ t('stock_management') }}</h1>
        </div>
        <form class="search-container" action="{{ url_for('home') }}" method="get" role="search" aria-label="{{ t('search_placeholder') }}">
            <label for="searchInput" class="sr-only">{{ t('search_placeholder') }}</label>
            <input id="searchInput" name="q" type="text" placeholder="{{ t('search_placeholder') }}" class="search-input" value="{{ request.args.get('q', '') }}">
            <button class="search-btn" aria-label="{{ t('search_placeholder') }}"><i class="bi bi-search"></i></button>
        </form>
        <nav class="menu" role="navigation" aria-label="menu principal">
            <a href="{{ url_for('home') }}" class="menu-btn" aria-label="{{ t('home') }}"><i class="bi bi-house-fill"></i> {{ t('home') }}</a>
            <a href="{{ url_for('adicionar_produto') }}" class="menu-btn" aria-label="{{ t('add_product') }}"><i class="bi bi-plus-circle"></i> {{ t('add_product') }}</a>
            <a href="{{ url_for('retirada') }}" class="menu-btn active" aria-label="{{ t('withdraw') }}"><i class="bi bi-box-arrow-left"></i> {{ t('withdraw') }}</a>
            <a href="{{ url_for('historico') }}" class="menu-btn" aria-label="{{ t('view_history') }}"><i class="bi bi-clock-history"></i> {{ t('view_history') }}</a>
            <a href="{{ url_for('logout') }}" class="menu-btn danger" aria-label="{{ t('logout') }}"><i class="bi bi-box-arrow-right"></i> {{ t('logout') }}</a>
        </nav>
        
        <!-- Language Switcher -->
        <div class="language-switcher">
            <a href="{{ url_for('change_language', lang='pt') }}" class="lang-btn {{ 'active' if lang == 'pt' else '' }}">ðŸ‡§ðŸ‡·</a>
            <a href="{{ url_for('change_language', lang='es') }}" class="lang-btn {{ 'active' if lang == 'es' else '' }}">ðŸ‡ªðŸ‡¸</a>
        </div>
    </header>

  <main class="main-container">
    <div class="scanner-container">
      <div class="scanner-icon">
        <i class="bi bi-upc-scan"></i>
      </div>
      <form id="form-retirada" action="/retirada" method="POST">
        <div id="campo-barra" class="input-group">
          <label for="codigo" class="sr-only">CÃ³digo de Barras:</label>
          <input type="text" 
               id="codigo" 
               name="codigo_de_barras" 
               class="scanner-input"
               placeholder="{{ t('scan_barcode') }}"
               autocomplete="off" 
               autofocus>
        </div>
                
        <div id="campo-validade" class="input-group" style="display: none;">
          <p class="validade-instruction">
            <i class="bi bi-info-circle"></i>
            {% if lang == 'es' %}
              Haga clic en una de las fechas de vencimiento a continuaciÃ³n para seleccionar el producto
            {% else %}
              Clique em uma das datas de validade abaixo para selecionar o produto
            {% endif %}
          </p>
          <div id="validade-options" class="validade-list" aria-live="polite"></div>
          <div class="validade-actions" style="width:100%; display:flex; justify-content:center; gap:12px;">
            <button type="button" id="voltar-btn" class="btn-voltar">
              <i class="bi bi-arrow-left-circle"></i>
              {{ t('back') }}
            </button>
          </div>
        </div>
      </form>
    </div>

    {% if error %}
    <div class="error-message">
      <i class="bi bi-exclamation-triangle"></i>
      {{ error }}
    </div>
    {% endif %}

    <!-- InstruÃ§Ãµes -->
    <div class="instructions">
      <h2><i class="bi bi-info-circle"></i> {{ t('withdraw_instructions_title') }}:</h2>
      <ol>
        <li>{{ t('scan_barcode') }}</li>
        <li>{{ t('scan_expiration') }}</li>
        <li>{{ t('continue') }}</li>
      </ol>
    </div>
  </main>

  <script src="{{ url_for('static', filename='scripts/retirada.js') }}"></script>
</body>
</html>